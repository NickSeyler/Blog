@model Blog.Models.BlogPost

@{
    ViewData["Title"] = "Details";
}

<h1>Details</h1>

<div>
    <h4>BlogPost</h4>
    <hr />
    <dl class="row">
        <dt class = "col-sm-2">
            @Html.DisplayNameFor(model => model.Title)
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.Title)
        </dd>
        <dt class = "col-sm-2">
            @Html.DisplayNameFor(model => model.Slug)
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.Slug)
        </dd>
        <dt class = "col-sm-2">
            @Html.DisplayNameFor(model => model.IsDeleted)
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.IsDeleted)
        </dd>
        <dt class = "col-sm-2">
            @Html.DisplayNameFor(model => model.Abstract)
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.Abstract)
        </dd>
        <dt class = "col-sm-2">
            @Html.DisplayNameFor(model => model.BlogPostState)
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.BlogPostState)
        </dd>
        <dt class = "col-sm-2">
            @Html.DisplayNameFor(model => model.Body)
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.Body)
        </dd>
        <dt class = "col-sm-2">
            @Html.DisplayNameFor(model => model.Created)
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.Created)
        </dd>
        <dt class = "col-sm-2">
            @Html.DisplayNameFor(model => model.Updated)
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.Updated)
        </dd>
        <dt class = "col-sm-2">
            @Html.DisplayNameFor(model => model.BlogItem)
        </dt>
        <dd class = "col-sm-10">
            @Html.DisplayFor(model => model.BlogItem.BlogName)
        </dd>
    </dl>
</div>

<hr />


@if(User.Identity!.IsAuthenticated)
{
    <div class="col col-md-8" id="CommentBox">
        <form asp-controller="Comments" asp-action="Create">
            <input type="hidden" name="BlogPostId" value=@Model.Id />
            <input type="hidden" asp-for="Slug" />
            <textarea class="form-control" name="CommentBody" rows="3" placeholder="Add Comment"></textarea>
            <button class="btn">Submit</button>
        </form>
    </div>
}

else
{
    <a asp-area="Identity" asp-page="/Account/Login" asp-route-returnUrl="@Url.Action("Details", "BlogPosts", new { slug = Model.Slug})">Please log in to leave a comment.</a>
}

<hr />

<div class="row">
@foreach(var comment in Model.Comments.OrderByDescending(c => c.CreatedDate))
{
    <div class="col-12 my-2">
        <div class="card border-dark mb-3 w-100">
          <div class="card-header">
              <span class="float-start">@comment.Author?.FullName</span>
              <span class="float-end">@comment.CreatedDate.ToString("MMM dd, yyyy")</span>
          </div>
          <div class="card-body text-dark">
            <h5 class="card-title">@comment.CommentBody</h5>
          </div>
        </div>
    </div>
}
</div>


<div>
    <a asp-action="Edit" asp-route-id="@Model?.Id">Edit</a> |
    <a asp-action="Index">Back to List</a>
</div>
